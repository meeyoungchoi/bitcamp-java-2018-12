<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/aop
        http://www.springframework.org/schema/aop/spring-aop.xsd
        http://www.springframework.org/schema/tx
        http://www.springframework.org/schema/tx/spring-tx.xsd">
  
 <tx:advice id="txAdvice">
        <tx:attributes>
            <!-- 트랜잭션을 적용하지 않을 메서드를 지정한다.
                 보통 getXXXX() 메서드는 데이터를 조회하기 때문에 트랜잭션을 사용할 필요가 없지만,
                 BoardService의 경우 조회할 때 조회수를 증가시키기 위해 데이터를 변경해야 한다.
                 따라서 우리 프로젝트의 경우 getXXX() 메서드에서도 트랜잭션을 사용해야 한다. -->
            <tx:method name="list*" read-only="true"/>
            
            <!-- 나머지 메서드는 트랜잭션을 적용한다.
                 그래서 이렇게 XML로 설정하려면 서비스 클래스의 메서드를 정의할 때 
                 규칙을 정해 메서드를 만들어야 한다. -->
            <tx:method name="*"/>
        </tx:attributes>
    </tx:advice>
    
    <!-- 트랜잭션 advice를 어떤 객체에 적용할 것인지 패턴을 설정해야 한다. -->
    <aop:config>
        <!-- 트랜잭션 advice를 적용할 대상을 정의한다. -->
        <aop:pointcut id="serviceOperation" 
                      expression="execution(* com.eomcs.lms.service.impl.*.*(..))"/>
        
        <!-- 그 대상에 트랜잭션 advice를 지정한다. -->
        <aop:advisor advice-ref="txAdvice" 
                     pointcut-ref="serviceOperation"/>
    </aop:config>
    
  
 
</beans>

















